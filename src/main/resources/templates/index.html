<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{fragments/layout :: layout(~{::content})}">
<body>
<div th:fragment="content">
    <!-- Hero Section -->
    <div class="card mb-4" style="background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%); border-radius: 20px;">
        <div class="card-body text-white text-center py-5">
            <h1 class="display-5 fw-bold mb-3">
                <i class="fas fa-home me-2"></i>Добро пожаловать в РиелтАгент
            </h1>
            <p class="lead mb-4">Профессиональная помощь в покупке, продаже и аренде недвижимости</p>
            <a th:href="@{/properties}" class="btn btn-light btn-lg px-5">
                <i class="fas fa-search me-2"></i>Смотреть все объекты
            </a>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card stat-card h-100 position-relative overflow-hidden">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-white-50">Всего объектов</h6>
                    <h2 class="card-title mb-0" th:text="${propertiesCount}">0</h2>
                    <small class="text-white-50">в базе</small>
                    <i class="fas fa-building stat-icon"></i>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card stat-card success h-100 position-relative overflow-hidden">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-white-50">Доступно</h6>
                    <h2 class="card-title mb-0" th:text="${availableCount}">0</h2>
                    <small class="text-white-50">для продажи</small>
                    <i class="fas fa-check-circle stat-icon"></i>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card stat-card warning h-100 position-relative overflow-hidden">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-white-50">Клиентов</h6>
                    <h2 class="card-title mb-0" th:text="${clientsCount}">0</h2>
                    <small class="text-white-50">зарегистрировано</small>
                    <i class="fas fa-users stat-icon"></i>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card stat-card danger h-100 position-relative overflow-hidden">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-white-50">Сделок</h6>
                    <h2 class="card-title mb-0" th:text="${dealsCount}">0</h2>
                    <small class="text-white-50">завершено</small>
                    <i class="fas fa-handshake stat-icon"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Properties -->
    <div class="card">
        <div class="card-header bg-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0"><i class="fas fa-building me-2 text-primary"></i>Доступная недвижимость</h5>
            <a th:href="@{/properties}" class="btn btn-sm btn-outline-primary">Смотреть все</a>
        </div>
        <div class="card-body">
            <div class="row" th:if="${recentProperties != null && !recentProperties.isEmpty()}">
                <div class="col-md-4 mb-4" th:each="property : ${recentProperties}">
                    <div class="card property-card h-100">
                        <img th:src="${property.imageUrl != null && !property.imageUrl.isEmpty() ? property.imageUrl : 'https://via.placeholder.com/400x200?text=Недвижимость'}"
                             class="card-img-top" alt="Фото объекта" style="height: 200px; object-fit: cover;">
                        <div class="card-body">
                            <div class="d-flex justify-content-between mb-2">
                                <span class="badge"
                                      th:classappend="${property.status.name() == 'AVAILABLE'} ? 'bg-success' : (${property.status.name() == 'RESERVED'} ? 'bg-warning' : 'bg-secondary')"
                                      th:text="${property.status.displayName}">Статус</span>
                                <span class="badge bg-info" th:text="${property.propertyType.displayName}">Тип</span>
                            </div>
                            <h5 class="card-title" th:text="${property.title}">Название</h5>
                            <p class="card-text text-muted">
                                <i class="fas fa-map-marker-alt me-1"></i>
                                <span th:text="${property.address}">Адрес</span>
                            </p>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span th:if="${property.rooms != null}">
                                    <i class="fas fa-door-open me-1"></i>
                                    <span th:text="${property.rooms}">3</span> комн.
                                </span>
                                <span>
                                    <i class="fas fa-ruler-combined me-1"></i>
                                    <span th:text="${property.area}">50</span> м²
                                </span>
                            </div>
                            <p class="property-price mb-2">
                                <span th:text="${#numbers.formatDecimal(property.price, 1, 'COMMA', 0, 'POINT')}">5 000 000</span> ₽
                            </p>
                            <a th:href="@{/properties/{id}(id=${property.id})}" class="btn btn-primary btn-sm w-100">
                                Подробнее
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div th:if="${recentProperties == null || recentProperties.isEmpty()}" class="text-center py-5">
                <i class="fas fa-home fa-3x text-muted mb-3"></i>
                <p class="text-muted">Пока нет доступных объектов недвижимости</p>
                <a th:href="@{/properties/new}" class="btn btn-primary">
                    <i class="fas fa-plus me-2"></i>Добавить первый объект
                </a>
            </div>
        </div>
    </div>
</div>
</body>
</html>
